<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Vanilla Coding | Bootcamp Prep</title>
    <link rel="stylesheet" href="assets/styles/module.css" />
    <link rel="stylesheet" href="assets/styles/index.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <h1 class="title">Welcome!<br />whack-a-mole</h1>
    </header>
    <div class="main">
      <div id="ending" class="ending">
        <p id="ending-box"></p>
      </div>
      <div id="ending-bg" class="ending-bg"></div>
      <ul class="whack-a-mole clearfix">
        <li class="mole">
          <img id="1" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="2" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="3" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="4" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="5" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="6" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="7" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="8" src="assets/images/mole.png" />
        </li>
        <li class="mole">
          <img id="9" src="assets/images/mole.png" />
        </li>
      </ul>
      <div class="point-box clearfix">
        <div class="point-wrap">
          <p id="point-text">Point :</p>
          <p id="count-mole">0</p>
          <p id="count-mole2">/10</p>
        </div>
        <div class="btn-wrap">
          <button type="button" class="start-btn">PRESS START</button>
        </div>
      </div>
    </div>
    <script>
      var startBtn = document.querySelector(".start-btn");

      startBtn.addEventListener("click", startMole);

      function startMole() {
        startBtn.removeEventListener("click", startMole);
        startBtn.style.color = "#3d3f43";
        getPoint = 0;
        turn = 0;
        setTimeout(showingMole, 1000);
      }
      var moleNumber;
      var randomNum;
      var preNum;

      function randomHole() {
        randomNum = Math.floor(Math.random() * 10);
        if (preNum !== randomNum && randomNum > 0) {
          preNum = randomNum;
          return randomNum;
        }
        return randomHole();
      }

      function moleActive(num) {
        num.classList.add("active");
      }
      function moleHide(num) {
        num.classList.remove("active");
      }
      var moleCatch = 0;

      function showingMole() {
        if (turn < 10) {
          moleNumber = document.getElementById(`${randomHole()}`);
          moleActive(moleNumber);
          moleNumber.addEventListener("click", catchMole);
          moleCatch = setTimeout(seeMOle, 800);
          turn++;
        } else {
          modalEvent();
          startBtn.addEventListener("click", startMole);
          startBtn.textContent = "PRESS AGAIN";
          startBtn.style.color = "#f2ecff";
        }
      }

      var endingBtn = document.querySelector("#ending-bg");
      var finalEnding = "finalEnding";

      endingBtn.addEventListener("click", hideModal);

      function modalEvent() {
        let point = (getPoint / 10) * 100;
        if (point <= 70) {
          ending.children[0].innerHTML =
            "<span>GAME OVER </span></br>YOUR SCORE IS&nbsp;&nbsp;<span class='last'>" +
            point +
            "</span>!<img src=assets/images/HellMole.png></br><span>사실 디그다는 헬창입니다ㅋ</span>";
        } else {
          ending.children[0].innerHTML =
            "<span>YOU WIN</span></br>YOUR SCORE IS&nbsp;&nbsp;<span class='last'>" +
            point +
            "</span>!";
        }
        ending.classList.add(finalEnding);
        endingBtn.classList.add(finalEnding);
      }
      function hideModal() {
        ending.classList.remove(finalEnding);
        endingBtn.classList.remove(finalEnding);
      }
      var cntBox = document.querySelector("#count-mole");
      function seeMOle() {
        moleNumber.removeEventListener("click", catchMole);
        moleHide(moleNumber);
        clearTimeout(moleCatch);
        setTimeout(showingMole, 1000);
      }

      function catchMole() {
        seeMOle();
        clearTimeout(moleCatch);
        getPoint++; // 두더지 잡으면 포인트 오름
        cntBox.innerHTML = getPoint;
      }
    </script>
  </body>
</html>
